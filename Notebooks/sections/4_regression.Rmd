
```{r}
d[, treated := ifelse(test = group != "control", yes = 1, no = 0)]
```

```{r}
d[, visual := ifelse(test = group == "visual treatment" | group == "text + visual treatment", yes = 1, no = 0)]
```

```{r}
d[, text := ifelse(test = group == "text treatment" | group == "text + visual treatment", yes = 1, no = 0)]
```

```{r}
head(d, 20)
```

```{r}
unique(d$group)
```

# What effect does simply getting any treatment at all versus none have on the clickthru rate?
```{r}
model_treat_at_all <- lm(clicked ~ treated, data = d)
model_treat_at_all
coeftest(model_treat_at_all, vcov = vcovHC(model_treat_at_all, type = "HC0"))
stargazer(model_treat_at_all,
          se=robust_se(model_treat_at_all),
          type="text")
```
# As we can see, if given any treatment, it corresponds to a 0.0008 (9.22e-05) increase in the clicked variable, which is an 0.0008 increase in the probability of them clicking, a small yet statistically significant difference. 

# Now let's see what the effect of a visual treatment is.

```{r}
model_visual <- lm(visual ~ clicked, data = d)
model_visual
coeftest(model_visual, vcov = vcovHC(model_visual, type = "HC0"))
```
# Receiving a visual treatment corresponds to a 0.111 (0.009) increase in the probability of someone clicking the ad.

# Now what about a text treatment?

```{r}
model_text <- lm(text ~ clicked, data = d)
model_text
coeftest(model_text, vcov = vcovHC(model_text, type = "HC0"))
```
# Receiving a text treatment corresponds to a 0.061 (0.011) decrease in the probability of someone clicking the ad.

# Now, let's look at each individual treatment group in relation to the control

```{r}
model_just_text <- lm(clicked ~ treated, data = d[d$group == "control" | group == "text treatment"])
model_just_text
coeftest(model_just_text, vcov = vcovHC(model_just_text, type = "HC0"))
```

```{r}
model_just_visual <- lm(clicked ~ treated, data = d[d$group == "control" | group == "visual treatment"])
model_just_visual
coeftest(model_just_visual, vcov = vcovHC(model_just_visual, type = "HC0"))
```

```{r}
model_text_visual <- lm(clicked ~ treated, data = d[d$group == "control" | group == "text + visual treatment"])
model_text_visual
coeftest(model_text_visual, vcov = vcovHC(model_text_visual, type = "HC0"))
```
# It seems as if the text treatments aren't having as big of an effect. Is adding the visual treatment on top of text more impactful than adding a text treatment on top of visual? 

```{r}
model_add_visual_to_text <- lm(clicked ~ visual, data = d[d$group == "text treatment" | group == "text + visual treatment"])
model_add_visual_to_text
coeftest(model_add_visual_to_text, vcov = vcovHC(model_add_visual_to_text, type = "HC0"))
```

```{r}
model_add_text_to_visual <- lm(clicked ~ text, data = d[d$group == "visual treatment" | group == "text + visual treatment"])
model_add_text_to_visual
coeftest(model_add_text_to_visual, vcov = vcovHC(model_add_text_to_visual, type = "HC0"))
```

# Let's explore the effect of gender on the clickthru rate.

```{r}
model_gender <- lm(clicked ~ gender, data = d[d$gender != "unknown"])
model_gender
coeftest(model_gender, vcov = vcovHC(model_gender, type = "HC0"))
```

```{r}
unique(d$age)
```

